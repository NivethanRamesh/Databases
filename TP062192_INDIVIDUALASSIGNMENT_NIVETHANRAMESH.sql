CREATE DATABASE APU_E_BOOKSTORE;

USE APU_E_BOOKSTORE;

CREATE TABLE PUBLISHER(
PUBLISHER_ID NVARCHAR(06) PRIMARY KEY NOT NULL,
PUBLISHER_NAME NVARCHAR(40) NOT NULL,
PUBLISHER_CONTACTNUMBER BIGINT,
PUBLISHER_EMAIL NVARCHAR(40),
PUBLISHER_COUNTRY NVARCHAR(40),
PUBLISHER_ADDRESS NVARCHAR(40) NOT NULL,
PUBLISHER_TOTALNUMBEROFBOOKSPUBLISHED INT )
INSERT INTO PUBLISHER VALUES
('PU0001', 'ALI', '0376234513', 'media@ALI.com', 'MALAYSIA', 'JALAN 3,PERMATA INDAH,KUALA LUMPUR', '2'),
('PU0002', 'CHONG','0364895067', 'media@CHONG.com', 'MALAYSIA', 'JALAN 5,DESA KEMANDOL,SELANGOR', '1'),
('PU0003', 'RAJU', '0315623759', 'media@RAJU.com', 'MALAYSIA', 'JALAN 6,MAHKOTTA,SELANGOR', '2'),
('PU0004', 'ALIA', '0309752967', 'media@ALIA.com', 'MALAYSIA', 'JALAN 7,SENTOSA,SELANGOR', '1'),
('PU0005', 'RAZAQ', '0311176547', 'media@RAZAQ.com', 'MALAYSIA', 'JALAN 15,DELIMA,SELANGOR', '1'),
('PU0006', 'GANGU', '0377590633', 'media@GANGU.com', 'MALAYSIA', 'JALAN 1,SERI BANTING,SELANGOR', '0'),
('PU0007', 'JINPANG', '0388885674', 'media@JINPANG.com', 'MALAYSIA', 'JALAN 1,LANGAT JAYA,SELANGOR', '3'),
('PU0008', 'JOHNNY', '0333221144', 'media@JOHNNY.com', 'MALAYSIA', 'JALAN 3,AMPANG,SELANOGR', '0'),
('PU0009', 'ZAMID', '0399784267', 'media@ZAMID.com', 'MALAYSIA', 'JALAN 2,BAUK,TERENGGANU', '0'),
('PU0010', 'RANVEER', '0343356789', 'media@RANVEER.com', 'MALAYSIA', 'JALAN 3,SEKAYU, TERENGGANU', '0');

SELECT *FROM PUBLISHER

CREATE TABLE E_BOOKSTORE_MANAGER(

MANAGER_ID NVARCHAR(06) PRIMARY KEY NOT NULL,
MANAGER_NAME NVARCHAR(40) NOT NULL,
MANAGER_GENDER NVARCHAR(40),
MANAGER_DATEOFBIRTH DATE NOT NULL,
MANAGER_CONTACTNUMBER BIGINT,
MANAGER_EMAIL NVARCHAR(40),
MANAGER_COUNTRY NVARCHAR(40),
MANAGER_ADDRESS NVARCHAR(40),
MANAGER_TOTALBOOKSORDERED INT )

INSERT INTO E_BOOKSTORE_MANAGER VALUES
('MG0001', 'JUSTIN', 'MALE','1975-01-10', '0187850998', 'JUSTIN@GMAIL.COM', 'MALAYSIA', ' PERTAMA JAYA,SELANGOR', '200'),
('MG0002', 'ASTRID', 'FEMALE','1978-08-01' , '0151223564', 'ASTRID@GMAIL.COM', 'MALAYSIA', 'TIARA,KUALA LUMPUR', '100'),
('MG0003', 'KEHLANI', 'FEMALE','1979-11-02', '0166685576', 'KEHLANI@GMAIL.COM', 'MALAYSIA', ' PERDANA,KUALA LUMPUR', '100'),
('MG0004', 'JEREMIH', 'FEMALE','1980-04-02' , '0133408569', 'JEREMIH@GMAIL.COM', 'MALAYSIA', ' JEMPOL,NEGERI SEMBILAN', '100'),
('MG0005', 'DHRUV', 'MALE','1977-06-05' , '0121574450', 'DHRUV@GMAIL.COM', 'MALAYSIA', ' SENDAYU,SELANGOR', '200'),
('MG0006', 'KAMAL', 'MALE','1994-07-22' , '0191423078', 'KAMAL@GMAIL.COM', 'MALAYSIA', ' AMPANG,SELANGOR', '0'),
('MG0007', 'HURON', 'MALE', '1967-08-21', '0118679987', 'HURON@GMAIL.COM', 'MALAYSIA', ' TEKALA,SELANGOR', '100'),
('MG0008', 'OMAR', 'MALE', '1968-12-15', '0134775607', 'OMAR@GMAIL.COM', 'MALAYSIA', ' AMPANG,SELANGOR', '100'),
('MG0009', 'DANIEL', 'MALE', '1969-01-10', '0154500968', 'DANIEL@GMAIL.COM', 'MALAYSIA', ' AMPANG,SELANGOR', '100'),
('MG0010', 'RAVENA', 'FEMALE', '1970-02-08', '0145560687', 'RAVENA@GMAIL.COM', 'MALAYSIA', ' AMPANG,SELANGOR', '0');

SELECT *FROM E_BOOKSTORE_MANAGER

CREATE TABLE MEMBER(

MEMBER_ID NVARCHAR(06) PRIMARY KEY NOT NULL,
MEMBER_NAME NVARCHAR(40) NOT NULL,
MEMBER_GENDER NVARCHAR(40),
MEMBER_DATEOFBIRTH DATE NOT NULL,
MEMBER_CONTACTNUMBER BIGINT,
MEMBER_EMAIL NVARCHAR(40),
MEMBER_COUNTRY NVARCHAR(40),
MEMBER_ADDRESS NVARCHAR(40),
MEMBER_TOTALNUMBEROFFEEDBACK INT )

INSERT INTO MEMBER VALUES
('MR0001', 'ALEX', 'MALE', '1987-07-06', '0142567748', 'ALEX@GMAIL.COM', 'MALAYSIA', 'JAYA INDAH,SELANGOR', '2' ),
('MR0002', 'SARAVANAN', 'MALE', '1990-05-15', '0127453098', 'SARAVANAN@GMAIL.COM', 'MALAYSIA', ' WARISAN,SELANGOR', '2' ),
('MR0003', 'LEE', 'MALE', '1981-04-03', '0137453098', 'LEE@GMAIL.COM', 'MALAYSIA', ' DUSUN,SELANGOR', '3' ),
('MR0004', 'XAVIER', 'MALE', '1982-05-04', '0147453098', 'XAVIER@GMAIL.COM', 'MALAYSIA', 'HULU LANGAT,SELANGOR', '0' ),
('MR0005', 'LEONARDO', 'MALE', '1983-06-05', '0167453098', 'LEONARDO@GMAIL.COM', 'MALAYSIA', 'TEKALA,SELANGOR', '0' ),
('MR0006', 'HARRIS', 'MALE', '1984-07-06', '0187453098', 'HARRIS@GMAIL.COM', 'MALAYSIA', ' SENDAYU,SELANGOR', '1' ),
('MR0007', 'AMBER', 'FEMALE', '1985-08-07', '0197453098', 'AMBER@GMAIL.COM', 'MALAYSIA', ' SERENDAH,SELANGOR', '0' ),
('MR0008', 'DYLAN', 'MALE', '1986-09-08', '0147453098', 'DYLAN@GMAIL.COM', 'MALAYSIA', ' SERENDAH,SELANGOR', '2' ),
('MR0009', 'YUSOF', 'MALE', '1987-10-09', '0157453098', 'YUSOF@GMAIL.COM', 'MALAYSIA', ' TEKALA,SELANGOR', '0' ),
('MR0010', 'KHAIRY', 'MALE', '1988-11-10', '0127453098', 'KHAIRY@GMAIL.COM', 'MALAYSIA', 'AMPANG,SELANGOR', '0' );

SELECT *FROM MEMBER

CREATE TABLE BOOKLIST(

BOOKLIST_ISBN INT PRIMARY KEY NOT NULL,
BOOKLIST_TITLE NVARCHAR(40) NOT NULL,
BOOKLIST_CATEGORY NVARCHAR(40) NOT NULL,
BOOKLIST_ORDEREDQUANTITY INT NOT NULL,
BOOKLIST_PRICE DECIMAL(6,2),
BOOKLIST_DATE DATE,
BOOKLIST_PUBLISHER_NAME NVARCHAR(40),
BOOKLIST_PUBLISHER_ID NVARCHAR(06) NOT NULL,
FOREIGN KEY (BOOKLIST_PUBLISHER_ID) REFERENCES PUBLISHER(PUBLISHER_ID) )

INSERT INTO BOOKLIST VALUES
('74905736', 'BUSINESS REVIEW', 'BUSINESS', '100', '80.80', '2022-02-12', 'ALI', 'PU0001'),
('74455673', 'ECONOMICS REVIEW', 'ECONOMICS', '100', '77.50', '2022-02-12', 'ALI', 'PU0001'),
('54995736', 'A TALE OF TWO BEES', 'FICTION', '100', '60.00', '2022-02-12', 'CHONG', 'PU0002'),
('64775756', 'CANCER: A STORY', 'FICTION', '100', '80.00', '2022-02-12', 'RAJU', 'PU0003'),
('34225788', 'INTRODUCTION TO C PROGRAMMING', 'COMPUTING', '100', '82.00', '2022-02-12', 'RAJU', 'PU0003'),
('24433573', 'INTRODUCTION TO DATABASE', 'COMPUTING', '100', '88.00', '2022-02-12', 'ALIA', 'PU0004'),
('14995736', 'MATHEMATICS FOR COMPUTING', 'COMPUTING', '100', '66.00', '2022-02-12', 'RAZAQ', 'PU0005'),
('94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', 'NON-FICTION', '100', '99.00', '2022-02-12', 'JINPANG', 'PU0007'),
('84085735', 'PYTHON FOR DATA ANALYSIS', 'COMPUTING', '100', '120.00', '2022-02-12', 'JINPANG', 'PU0007'),
('64586747', 'SYSTEMS FOR GREEN ENGINEERING', 'ENGINEERING', '100', '110.00', '2022-02-12', 'JINPANG', 'PU0007');

SELECT *FROM BOOKLIST

CREATE TABLE BOOK(

BOOK_ISBN INT PRIMARY KEY NOT NULL,
BOOK_TITLE NVARCHAR(40) NOT NULL,
BOOK_CATEGORY NVARCHAR(40) NOT NULL,
BOOK_QUANTITY INT NOT NULL,
BOOK_PRICE DECIMAL(6,2),
BOOK_DATE DATE,
BOOK_PUBLISHER_NAME NVARCHAR(40),
BOOK_PUBLISHER_ID NVARCHAR(06) NOT NULL,
BOOK_FEEDBACK_ID NVARCHAR(06) NOT NULL,
FOREIGN KEY (BOOK_PUBLISHER_ID) REFERENCES PUBLISHER(PUBLISHER_ID),
FOREIGN KEY (BOOK_FEEDBACK_ID) REFERENCES FEEDBACK(FEEDBACK_ID) )

INSERT INTO BOOK VALUES
('74905736', 'BUSINESS REVIEW', 'BUSINESS', '90', '80.80', '2022-02-12', 'ALI', 'PU0001', 'FD0001'),
('74455673', 'ECONOMICS REVIEW', 'ECONOMICS', '80', '77.50', '2022-02-12', 'ALI', 'PU0001', 'FD0002'),
('54995736', 'A TALE OF TWO BEES', 'FICTION', '85', '60.00', '2022-02-12', 'CHONG', 'PU0002', 'FD0003'),
('64775756', 'CANCER: A STORY', 'FICTION', '88', '80.00', '2022-02-12', 'RAJU', 'PU0003', 'FD0004'),
('34225788', 'INTRODUCTION TO C PROGRAMMING', 'COMPUTING', '75', '82.00', '2022-02-12', 'RAJU', 'PU0003', 'FD0005'),
('24433573', 'INTRODUCTION TO DATABASE', 'COMPUTING', '70', '88.00', '2022-02-12', 'ALIA', 'PU0004', 'FD0006'),
('14995736', 'MATHEMATICS FOR COMPUTING', 'COMPUTING', '65', '66.00', '2022-02-12', 'RAZAQ', 'PU0005', 'FD0007'),
('94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', 'NON-FICTION', '85', '99.00', '2022-02-12', 'JINPANG', 'PU0007', 'FD0008'),
('84085735', 'PYTHON FOR DATA ANALYSIS', 'COMPUTING', '90', '120.00', '2022-02-12', 'JINPANG', 'PU0007', 'FD0009'),
('64586747', 'SYSTEMS FOR GREEN ENGINEERING', 'ENGINEERING', '90', '110.00', '2022-02-12', 'JINPANG', 'PU0007', 'FD0010');

SELECT *FROM BOOK;


CREATE TABLE INVENTORY(

IV_ENTRANCENUMBER NVARCHAR(08) PRIMARY KEY NOT NULL,
IV_ID NVARCHAR(06) NOT NULL,
IV_BOOK_ISBN INT NOT NULL,
IV_BOOK_TITLE NVARCHAR(40) NOT NULL,
IV_BOOK_CATEGORY NVARCHAR(40) NOT NULL,
IV_BOOK_QUANTITY INT,
IV_BOOK_PRICE DECIMAL(6,2),
IV_BOOK_DATE DATE,
IV_PUBLISHER_NAME NVARCHAR(40),
IV_PUBLISHER_ID NVARCHAR(06),
IV_MANAGER_NAME NVARCHAR(40),
IV_MANAGER_ID NVARCHAR(06) 
FOREIGN KEY (IV_PUBLISHER_ID) REFERENCES PUBLISHER(PUBLISHER_ID),
FOREIGN KEY (IV_MANAGER_ID) REFERENCES E_BOOKSTORE_MANAGER(MANAGER_ID),
FOREIGN KEY (IV_BOOK_ISBN) REFERENCES BOOK (BOOK_ISBN) )


INSERT INTO INVENTORY VALUES
('39854748', 'IN0001','74905736', 'BUSINESS REVIEW', 'BUSINESS', '90', '80.80', '2022-02-12', 'ALI', 'PU0001', 'JUSTIN', 'MG0001'),
('39556748', 'IN0002','74455673', 'ECONOMICS REVIEW', 'ECONOMICS', '80', '77.50', '2022-02-12', 'ALI', 'PU0001', 'JUSTIN', 'MG0001'),
('39856238', 'IN0003','54995736', 'A TALE OF TWO BEES', 'FICTION', '85', '60.00', '2022-02-12', 'CHONG', 'PU0002', 'ASTRID', 'MG0002'),
('97856748', 'IN0004','64775756', 'CANCER: A STORY', 'FICTION', '88', '80.00', '2022-02-12', 'RAJU', 'PU0003', 'KEHLANI', 'MG0003'),
('39812748', 'IN0005','34225788', 'INTRODUCTION TO C PROGRAMMING', 'COMPUTING', '75', '82.00', '2022-02-12', 'RAJU', 'PU0003', 'JEREMIH', 'MG0004'),
('45856748', 'IN0006','24433573', 'INTRODUCTION TO DATABASE', 'COMPUTING', '70', '88.00', '2022-02-12', 'ALIA', 'PU0004', 'DHRUV', 'MG0005'),
('39856454', 'IN0007','14995736', 'MATHEMATICS FOR COMPUTING', 'COMPUTING', '65', '66.00', '2022-02-12', 'RAZAQ', 'PU0005', 'DHRUV', 'MG0005'),
('39856123', 'IN0008','94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', 'NON-FICTION', '85', '99.00', '2022-02-12', 'JINPANG', 'PU0007', 'HURON', 'MG0007'),
('37635674', 'IN0009','84085735', 'PYTHON FOR DATA ANALYSIS', 'COMPUTING', '90', '120.00', '2022-02-12', 'JINPANG', 'PU0007', 'OMAR', 'MG0008'),
('39456506', 'IN0010','64586747', 'SYSTEMS FOR GREEN ENGINEERING', 'ENGINEERING', '90', '110.00', '2022-02-12', 'JINPANG', 'PU0007', 'DANIEL', 'MG0009');

SELECT *FROM INVENTORY

CREATE TABLE SHOPPINGCART(

SHOPPINGCART_BOOK_ISBN INT PRIMARY KEY NOT NULL,
SHOPPINGCART_BOOK_TITLE NVARCHAR(40) NOT NULL,
SHOPPINGCART_BOOK_CATEGORY NVARCHAR(40) NOT NULL,
SHOPPINGCART_BOOK_QUANTITY INT,
SHOPPINGCART_BOOK_PRICE DECIMAL(6,2),
SHOPPINGCART_BOOK_DATE DATE,
SHOPPINGCART_MEMBER_NAME NVARCHAR(40),
SHOPPINGCART_MEMBER_ID NVARCHAR(06),
SHOPPINGCART_MEMBER_ADDRESS NVARCHAR(40),
SHOPPINGCART_MEMBER_CONTACTNUMBER BIGINT,
SHOPPINGCART_DATE DATE,
SHOPPINGCART_QUANTITY INT,
FOREIGN KEY (SHOPPINGCART_BOOK_ISBN) REFERENCES BOOK(BOOK_ISBN),
FOREIGN KEY (SHOPPINGCART_MEMBER_ID) REFERENCES MEMBER(MEMBER_ID) )

INSERT INTO SHOPPINGCART VALUES
('74905736', 'BUSINESS REVIEW', 'BUSINESS', '90', '80.80', '2022-02-12', 'ALEX', 'MR0001', 'JAYA INDAH,SELANGOR','0142567748', '2022-02-22','10'),
('74455673', 'ECONOMICS REVIEW', 'ECONOMICS', '80', '77.50', '2022-02-12', 'ALEX', 'MR0001','JAYA INDAH,SELANGOR','0142567748', '2022-02-22','20'),
('54995736', 'A TALE OF TWO BEES', 'FICTION', '85', '60.00', '2022-02-12', 'SARAVANAN', 'MR0002','WARISAN,SELANGOR','0127453098', '2022-02-23','15'),
('64775756', 'CANCER: A STORY', 'FICTION', '88', '80.00', '2022-02-12', 'SARAVANAN', 'MR0002','WARISAN,SELANGOR','0127453098', '2022-02-23','12'),
('34225788', 'INTRODUCTION TO C PROGRAMMING', 'COMPUTING', '75', '82.00', '2022-02-12', 'LEE', 'MR0003','DUSUN,SELANGOR','0137453098', '2022-02-28','25'),
('24433573', 'INTRODUCTION TO DATABASE', 'COMPUTING', '70', '88.00', '2022-02-12', 'LEE', 'MR0003','DUSUN,SELANGOR','0137453098', '2022-02-28','30'),
('14995736', 'MATHEMATICS FOR COMPUTING', 'COMPUTING', '65', '66.00', '2022-02-12', 'LEE', 'MR0003','DUSUN,SELANGOR','0137453098', '2022-02-28','35'),
('94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', 'NON-FICTION', '85', '99.00', '2022-02-12', 'HARRIS', 'MR0006','SENDAYU,SELANGOR','0187453098', '2022-02-22','15'),
('84085735', 'PYTHON FOR DATA ANALYSIS', 'COMPUTING', '90', '120.00', '2022-02-12', 'DYLAN', 'MR0008','SERENDAH,SELANGOR','0147453098', '2022-02-24','10'),
('64586747', 'SYSTEMS FOR GREEN ENGINEERING', 'ENGINEERING', '90', '110.00', '2022-02-12', 'DYLAN', 'MR0008','SERENDAH,SELANGOR','0147453098', '2022-02-24','10');

SELECT *FROM SHOPPINGCART

CREATE TABLE INVOICE(
 
 INVOICE_NUMBER INT PRIMARY KEY NOT NULL,
 INVOICE_BOOK_ISBN INT NOT NULL,
 INVOICE_BOOK_TITLE NVARCHAR(40) NOT NULL,
 INVOICE_TOTALQUANTITY INT,
 INVOICE_TOTALAMOUNT DECIMAL(8,2),
 INVOICE_PUBLISHER_ID NVARCHAR(06),
 INVOICE_PUBLISHER_NAME NVARCHAR(40),
 FOREIGN KEY (INVOICE_PUBLISHER_ID) REFERENCES PUBLISHER(PUBLISHER_ID),
 FOREIGN KEY (INVOICE_BOOK_ISBN) REFERENCES BOOK(BOOK_ISBN)  )

 INSERT INTO INVOICE VALUES
 ('94031','74905736', 'BUSINESS REVIEW', '100', '8080.00','PU0001', 'ALI' ),
 ('94032','74455673', 'ECONOMICS REVIEW', '100', '7750.00','PU0001', 'ALI'),
 ('94033','54995736', 'A TALE OF TWO BEES', '100', '6000.00','PU0002','CHONG' ),
 ('94034','64775756', 'CANCER: A STORY', '100', '8000.00','PU0003', 'RAJU' ),
 ('94035','34225788', 'INTRODUCTION TO C PROGRAMMING', '100', '8200.00','PU0003', 'RAJU' ),
 ('94036','24433573', 'INTRODUCTION TO DATABASE', '100', '8800.00','PU0004', 'ALIA'),
 ('94037','14995736', 'MATHEMATICS FOR COMPUTING', '100', '6600.00','PU0005', 'RAZAQ' ),
 ('94038','94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', '100', '9900.00','PU0007','JINPANG' ),
 ('94039','84085735', 'PYTHON FOR DATA ANALYSIS', '100', '12000.00','PU0007','JINPANG' ),
 ('94040','64586747', 'SYSTEMS FOR GREEN ENGINEERING', '100', '11000.00','PU0007','JINPANG' );


 SELECT *FROM INVOICE


 CREATE TABLE FEEDBACK(
 
 FEEDBACK_ID NVARCHAR(06) PRIMARY KEY NOT NULL,
 FEEDBACK_BOOKLIST_ISBN INT NOT NULL,
 FEEDBACK_BOOKLIST_TITLE NVARCHAR(40) NOT NULL,
 FEEDBACK_BOOKRATING INT,
 FEEDBACK_COMMENTS NVARCHAR(60),
 FEEDBACK_MEMBER_ID NVARCHAR(06),
 FEEDBACK_MEMBER_NAME NVARCHAR(40),
 FOREIGN KEY (FEEDBACK_BOOKLIST_ISBN) REFERENCES BOOKLIST(BOOKLIST_ISBN),
 FOREIGN KEY (FEEDBACK_MEMBER_ID) REFERENCES MEMBER(MEMBER_ID)  )

 INSERT INTO FEEDBACK VALUES
 ('FD0001','74905736', 'BUSINESS REVIEW', '8', 'NICE BOOK!','MR0001', 'ALEX'),
 ('FD0002','74455673', 'ECONOMICS REVIEW', '5', 'BEST ECONOMIC BOOKS!','MR0001','ALEX'),
 ('FD0003','54995736', 'A TALE OF TWO BEES', '6', 'FEEL NICE BOOK.','MR0002', 'SARAVANAN'),
 ('FD0004','64775756', 'CANCER: A STORY', '7', 'STORY ABOUT AWARENESS IS GREAT FOR ANYONE.','MR0002', 'SARAVANAN'),
 ('FD0005','34225788', 'INTRODUCTION TO C PROGRAMMING', '10', 'BEST FOR INTRODUCTORY FOR ANY BEGINNERS IN PROGRAMMING.','MR0003' ,'LEE'),
 ('FD0006','24433573', 'INTRODUCTION TO DATABASE', '4', 'WANT TO BUILD DATABASE? READ THIS BOOK! IT IS GREAT','MR0003','LEE'),
 ('FD0007','14995736', 'MATHEMATICS FOR COMPUTING', '3', 'EYE OPENING AND SOLVED REAL WORLD PROBLEMS!','MR0003','LEE'),
 ('FD0008','94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', '7', 'CAN BUILD SYSTEMS BECAUSE OF GREAT GUIDELINES FROM THE BOOK!','MR0006','HARRIS'),
 ('FD0009','84085735', 'PYTHON FOR DATA ANALYSIS', '9', 'BEST DATA ANALYSIS BOOK!','MR0008','DYLAN'),
 ('FD0010','64586747', 'SYSTEMS FOR GREEN ENGINEERING', '10', 'PACKED WITH INVALUABLE KNOWLEDGE FOUND IN ANY OTHER BOOK!','MR0008','DYLAN');

 SELECT *FROM FEEDBACK

 CREATE TABLE PURORDER(

PURORDER_ID NVARCHAR(06) PRIMARY KEY NOT NULL,
PURORDER_DATE DATE NOT NULL,
PURORDER_QUANTITYORDERED INT NOT NULL,
PURORDER_TOTALPRICE DECIMAL(8,2),
PURORDER_BOOK_ISBN  INT,
PURORDER_BOOK_TITLE NVARCHAR(40),
PURORDER_PUBLISHER_ID NVARCHAR(06),
PURORDER_PUBLISHER_NAME NVARCHAR(40),
PURORDER_MANAGER_ID NVARCHAR(06) ,
PURORDER_MANAGER_NAME NVARCHAR(40),
FOREIGN KEY (PURORDER_BOOK_ISBN) REFERENCES BOOK(BOOK_ISBN),
FOREIGN KEY (PURORDER_PUBLISHER_ID) REFERENCES PUBLISHER(PUBLISHER_ID),
FOREIGN KEY (PURORDER_MANAGER_ID) REFERENCES E_BOOKSTORE_MANAGER(MANAGER_ID) )

INSERT INTO PURORDER VALUES
('PR0001','2022-02-10','100', '8080.00','74905736', 'BUSINESS REVIEW','PU0001', 'ALI','MG0001','JUSTIN'),
('PR0002','2022-02-10','100', '7750.00','74455673', 'ECONOMICS REVIEW','PU0001' ,'ALI','MG0001', 'JUSTIN'),
('PR0003','2022-02-10','100', '6000.00','54995736', 'A TALE OF TWO BEES','PU0002', 'CHONG','MG0002', 'ASTRID'),
('PR0004','2022-02-10','100', '8000.00','64775756', 'CANCER: A STORY','PU0003', 'RAJU','MG0003', 'KEHLANI'),
('PR0005','2022-02-10','100', '8200.00','34225788', 'INTRODUCTION TO C PROGRAMMING','PU0003', 'RAJU', 'MG0004', 'JEREMIH'),
('PR0006','2022-02-10','100', '8800.00','24433573' ,'INTRODUCTION TO DATABASE','PU0004', 'ALIA', 'MG0005', 'DHRUV'),
('PR0007','2022-02-10','100', '6600.00','14995736', 'MATHEMATICS FOR COMPUTING','PU0005', 'RAZAQ','MG0005' ,'DHRUV'),
('PR0008','2022-02-10','100', '9900.00','94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', 'PU0007', 'JINPANG', 'MG0007','HURON'),
('PR0009','2022-02-10','100', '12000.00','84085735', 'PYTHON FOR DATA ANALYSIS','PU0007','JINPANG','MG0008', 'OMAR'),
('PR0010','2022-02-10','100', '11000.00','64586747', 'SYSTEMS FOR GREEN ENGINEERING','PU0007', 'JINPANG','MG0009', 'DANIEL');

SELECT *FROM PURORDER

CREATE TABLE MEMORDER(

MEMORDER_ID NVARCHAR(06) PRIMARY KEY NOT NULL,
MEMORDER_DATE DATE NOT NULL,
MEMORDER_QUANTITY INT NOT NULL,
MEMORDER_TOTALPRICE DECIMAL(8,2),
MEMORDER_BOOK_ISBN  INT,
MEMORDER_BOOK_TITLE NVARCHAR(40),
MEMORDER_PUBLISHER_ID NVARCHAR(06),
MEMORDER_PUBLISHER_NAME NVARCHAR(40),
MEMORDER_MEMBER_ID NVARCHAR(06) ,
MEMORDER_MEMBER_NAME NVARCHAR(40),
MEMORDER_MEMBER_CONTACTNUMBER BIGINT,
MEMORDER_DELIVERYSTATUS NVARCHAR(40),
MEMORDER_MEMBER_ADDRESS NVARCHAR(40),
FOREIGN KEY (MEMORDER_BOOK_ISBN) REFERENCES BOOK(BOOK_ISBN),
FOREIGN KEY (MEMORDER_PUBLISHER_ID) REFERENCES PUBLISHER(PUBLISHER_ID),
FOREIGN KEY (MEMORDER_MEMBER_ID) REFERENCES MEMBER(MEMBER_ID) )

INSERT INTO MEMORDER VALUES
('CU0001','2022-02-22','10', '8080.00','74905736', 'BUSINESS REVIEW','PU0001', 'ALI','MR0001','ALEX','0142567748', 'DELIVERED','JAYA INDAH,SELANGOR'),
('CU0002','2022-02-22','20', '7750.00','74455673', 'ECONOMICS REVIEW','PU0001' ,'ALI','MR0001', 'ALEX','0142567748','DELIVERED','JAYA INDAH,SELANGOR'),
('CU0003','2022-02-23','15', '6000.00','54995736', 'A TALE OF TWO BEES','PU0002', 'CHONG','MR0002', 'SARAVANAN','0127453098','NOT DELIVERED','WARISAN,SELANGOR'),
('CU0004','2022-02-23','12', '8000.00','64775756', 'CANCER: A STORY','PU0003', 'RAJU','MR0003', 'LEE','0137453098','DELIVERED','WARISAN,SELANGOR'),
('CU0005','2022-02-28','25', '8200.00','34225788', 'INTRODUCTION TO C PROGRAMMING','PU0003', 'RAJU', 'MR0004', 'XAVIER','0147453098','DELIVERED','DUSUN,SELANGOR'),
('CU0006','2022-02-28','30', '8800.00','24433573' ,'INTRODUCTION TO DATABASE','PU0004', 'ALIA', 'MR0005', 'LEONARDO','0167453098','NOT DELIVERED','DUSUN,SELANGOR'),
('CU0007','2022-02-28','35', '6600.00','14995736', 'MATHEMATICS FOR COMPUTING','PU0005', 'RAZAQ','MR0005' ,'LEONARDO','0167453098','DELIVERED','DUSUN,SELANGOR'),
('CU0008','2022-02-22','15', '9900.00','94775736', 'SYSTEM DESIGN AND ANALYSIS: INTRODUCTION', 'PU0007', 'JINPANG', 'MR0007','AMBER','0197453098','DELIVERED','SENDAYU,SELANGOR'),
('CU0009','2022-02-24','10', '12000.00','84085735', 'PYTHON FOR DATA ANALYSIS','PU0007','JINPANG','MR0008', 'DYLAN','0147453098','NOT DELIVERED','SERENDAH,SELANGOR'),
('CU0010','2022-02-24','10', '11000.00','64586747', 'SYSTEMS FOR GREEN ENGINEERING','PU0007', 'JINPANG','MR0009', 'YUSOF','0157453098','DELIVERED','SERENDAH,SELANGOR');

SELECT *FROM MEMORDER




--DATA MANIPULATION LANGUAGE(DML)

-- Q1

SELECT FEEDBACK_BOOKLIST_ISBN, FEEDBACK_BOOKLIST_TITLE, AVG(FEEDBACK_BOOKRATING)
FROM FEEDBACK 
WHERE FEEDBACK_BOOKLIST_ISBN IN ( SELECT FEEDBACK_BOOKLIST_ISBN FROM FEEDBACK WHERE FEEDBACK_BOOKRATING =10)
ORDER BY FEEDBACK_BOOKLIST_TITLE;

--Q2

SELECT MEMBER_ID, MEMBER_NAME, MEMBER_TOTALNUMBEROFFEEDBACK
FROM MEMBER ;


SELECT FEEDBACK_MEMBER_ID, FEEDBACK_MEMBER_NAME, FEEDBACK_COMMENTS, COUNT(*)
FROM FEEDBACK
WHERE FEEDBACK_MEMBER_ID IN (SELECT FEEDBACK_MEMBER_ID FROM FEEDBACK WHERE FEEDBACK_BOOKLIST_ISBN = ' ' )
GROUP BY FEEDBACK_MEMBER_ID ;


--Q3
SELECT PUBLISHER_ID, PUBLISHER_NAME, PUBLISHER_TOTALNUMBEROFBOOKSPUBLISHED
FROM PUBLISHER ;


SELECT BOOKLIST_PUBLISHER_ID, BOOKLIST_PUBLISHER_NAME, BOOKLIST_TITLE
FROM BOOKLIST
GROUP BY BOOKLIST_PUBLISHER_NAME
ORDER BY BOOKLIST_TITLE DESC ;

--Q4

SELECT MANAGER_ID, MANAGER_NAME, MANAGER_TOTALBOOKSORDERED
FROM E_BOOKSTORE_MANAGER ;

SELECT PURORDER_DATE, PURORDER_PUBLISHER_NAME, PURORDER_MANAGER_NAME, PURORDER_QUANTITYORDERED
FROM PURORDER
GROUP BY PURORDER_MANAGER_NAME
ORDER BY PURORDER_QUANTITYORDERED DESC ;

--Q5

SELECT BOOK_TITLE, BOOK_PRICE, BOOK_ORDEREDQUANTITY
FROM BOOK
WHERE BOOK_ORDEREDQUANTITY >= 250 
ORDER BY BOOK_ORDEREDQUANTITY DESC, BOOK_TITLE ;

--Q6

SELECT SHOPPINGCART_BOOK_ISBN, SUM(SHOPPINGCART_BOOK_QUANTITY) AS TOTAL_QUANTITY
FROM SHOPPINGCART
GROUP BY SHOPPINGCART_BOOK_ISBN
ORDER BY TOTAL_QUANTITY DESC ;

--Q7

SELECT SHOPPINGCART_MEMBER_ID, MAX(SHOPPINGCART_BOOK_PRICE)
FROM SHOPPINGCART
GROUP BY MAX(SHOPPINGCART_BOOK_PRICE) DESC ;

--Q8

SELECT MEMBER_NAME
FROM MEMBER
WHERE MEMBER_ID NOT IN (SELECT MEMBER_ID FROM SHOPPINGCART)

--Q9

SELECT SHOPPINGCART_MEMBER_ID,SHOPPINGCART_MEMBER_ADDRESS,SHOPPINGCART_MEMBER_CONTACTNUMBER, SHOPPINGCART_BOOK_ISBN, SHOPPINGCART_BOOK_TITLE, SHOPPINGCART_BOOK_QUANTITY, SHOPPINGCART_BOOK_DATE, SHOPPINGCART_DELIVERYSTATUS
FROM SHOPPINGCART
WHERE SHOPPINGCART_DELIVERYSTATUS = 'NOT DELIVERED'

--Q10

SELECT SHOPPINGCART_MEMBER_ID, COUNT(*) AS COUNT_ORDER
FROM SHOPPINGCART
GROUP BY SHOPPINGCART_MEMBER_ID
HAVING COUNT(*) > 2 ;



--DATA MANIPULATION LANGUAGE(DML)

-- Q1

SELECT FEEDBACK_BOOKLIST_ISBN, FEEDBACK_BOOKLIST_TITLE, AVG(FEEDBACK_BOOKRATING), COUNT(*) AS AVERAGE
FROM FEEDBACK 
WHERE COUNT(*) > AVG(FEEDBACK_BOOKRATING)
GROUP BY FEEDBACK_BOOKLIST_ISBN,FEEDBACK_BOOKLIST_TITLE, COUNT(*);


--Q2

SELECT FEEDBACK_MEMBER_ID, FEEDBACK_MEMBER_NAME, SUM(FEEDBACK_COMMENTS), COUNT(*) AS TOTAL
FROM FEEDBACK
WHERE COUNT(*) = SUM(FEEDBACK_COMMENTS)
GROUP BY FEEDBACK_MEMBER_ID,FEEDBACK_MEMBER_NAME,COUNT(*) ;

--Q3


SELECT PUBLISHER_ID, PUBLISHER_NAME, PUBLISHER_TOTALNUMBEROFBOOKSPUBLISHED,COUNT(*) AS TOTAL_BOOKS
FROM PUBLISHER 
WHERE COUNT(*) > 0
GROUP BY PUBLISHER_ID, PUBLISHER_NAME, COUNT(*)
ORDER BY TOTAL_BOOKS;

--Q4

SELECT PURORDER_DATE, PURORDER_PUBLISHER_NAME, PURORDER_MANAGER_NAME, SUM(PURORDER_QUANTITYORDERED),COUNT(*) AS TOTAL
FROM PURORDER
WHERE COUNT(*) = SUM(PURORDER_QUANTITYORDERED)
GROUP BY PURORDER_MANAGER_NAME,PURORDER_PUBLISHER_NAME,PURORDER_DATE
ORDER BY TOTAL DESC ;

--Q5

SELECT BOOK_TITLE, BOOK_PRICE, AVG(BOOK_QUANTITY),COUNT(*) AS TOTAL_BOOK_QUANTITY
FROM BOOK
WHERE COUNT(*) > AVG(BOOK_QUANTITY)
ORDER BY TOTAL_BOOK_QUANTITY DESC, BOOK_TITLE,BOOK_PRICE ;

--Q6

SELECT MEMORDER_BOOK_ISBN, SUM(MEMORDER_QUANTITY) AS TOTAL_QUANTITY
FROM MEMORDER
GROUP BY MEMORDER_BOOK_ISBN, MEMORDER_BOOK_TITLE
ORDER BY TOTAL_QUANTITY DESC ;

--Q7

SELECT MEMORDER_MEMBER_ID,MEMORDER_MEMBER_NAME, SUM(MEMORDER_TOTALPRICE)
FROM MEMORDER
GROUP BY MEMORDER_MEMBER_NAME,SUM(MEMORDER_TOTALPRICE)
ORDER BY MAX(MEMORDER_TOTALPRICE);

--Q8

SELECT MEMBER_NAME
FROM MEMBER
WHERE MEMBER_ID NOT IN (SELECT SHOPPINGCART_MEMBER_ID FROM SHOPPINGCART) ;

--Q9

SELECT MEMORDER_MEMBER_ID,MEMORDER_MEMBER_ADDRESS,MEMORDER_MEMBER_CONTACTNUMBER, MEMORDER_BOOK_ISBN, 
MEMORDER_BOOK_TITLE, MEMORDER_QUANTITY, MEMORDER_DATE, MEMORDER_DELIVERYSTATUS
FROM MEMORDER
WHERE MEMORDER_DELIVERYSTATUS = 'NOT DELIVERED' 
GROUP BY MEMORDER_MEMBER_ID,MEMORDER_MEMBER_ADDRESS,MEMORDER_MEMBER_CONTACTNUMBER, MEMORDER_BOOK_ISBN, 
MEMORDER_BOOK_TITLE, MEMORDER_QUANTITY, MEMORDER_DATE, MEMORDER_DELIVERYSTATUS;

--Q10

SELECT MEMORDER_MEMBER_ID, COUNT(*) AS COUNT_ORDER
FROM MEMORDER
GROUP BY MEMORDER_MEMBER_ID 
HAVING COUNT(*) > 2 ;

